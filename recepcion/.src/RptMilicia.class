' Gambas class file


Public $sql As String
Public $result As Result
Private Hcox As Connection
Public piso As String
Public fecha As String
Public hora As String
Public usuario As String

Public Sub _new()

Dim RHBox As ReportHBox 
Dim Rep2, Rep3, Rep4, Rep5, Rep6, Rep7, Rep8 As Reportlabel

usuario = UCase(inicio.nombreusuario)
fecha = Format$(Date, "dd/mm/yy")
hora = Format$(Time, "hh:nn")
Rptefecha.Text = fecha
Reporhora.Text = hora
Reportusuario.Text = usuario

conexion.Connect()

$sql = "SELECt * FROM visitas where retirado ='" & 0 & "' order by piso"
$result = conexion.Con.Exec($sql)

For Each $result

RHBox = New ReportHBox(listabox)
RHBox.Height = "5mm"
RHBox.Font.Size = "1"

Rep2 = New ReportLabel(RHBox)
Rep2.Width = "20mm"
Rep2.Alignment = Align.Left
Rep2.Text = $result!cedulavisitante
 
Rep3 = New ReportLabel(RHBox)
Rep3.Width = "80mm"
Rep3.Alignment = Align.Left
Rep3.Text = $result!nombrevisitante

Rep4 = New ReportLabel(RHBox)
Rep4.Width = "63mm"
Rep4.Alignment = Align.Left
Rep4.Text = $result!departamento

Rep5 = New ReportLabel(RHBox)
Rep5.Width = "15mm"
Rep5.Alignment = Align.Center
Rep5.Text = $result!piso

Rep6 = New ReportLabel(RHBox)
Rep6.Width = "8mm"
Rep6.Alignment = Align.Justify
Rep6.Text = $result!habitacion

Rep7 = New ReportLabel(RHBox)
Rep7.Width = "10mm"
Rep7.Alignment = Align.Justify
Rep7.Text = $result!cama

Rep8 = New ReportLabel(RHBox)
Rep8.Width = "60mm"
Rep8.Alignment = Align.Justify
Rep8.Text = $result!personavisitar

Next

End
